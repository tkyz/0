#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail

(

  hook_name="${0##*/}"

  stdin=($(cat /dev/stdin))

  function _debug() {
    printf "\e[2m"
    echo '---'
    echo "${0}:"
    echo '  env:'
    export | sed 's/declare -x /    - /g'
    echo '  args:'
    for item in "${@}"; do
      echo "    - ${item}"
    done
    echo '  stdin:'
    for item in "${stdin[@]}"; do
      echo "    - ${item}"
    done
    printf "\e[0m"
  }

  #----------------------------------------------------------------
  # local hook

  if [[ 'pre-commit' == "${hook_name}" ]]; then
    _debug
    git validate

  elif [[ 'post-commit' == "${hook_name}" ]]; then
    _debug

  elif [[ 'pre-push' == "${hook_name}" ]]; then
    _debug

  #----------------------------------------------------------------
  # remote hook

  elif [[ 'pre-receive' == "${hook_name}" ]]; then
    _debug
#   _validate

  elif [[ 'post-receive' == "${hook_name}" ]]; then
    _debug
  fi

)
